# 🎨 AI Painter 使用指南

## 🚀 快速开始

### 1. 启动服务器

```bash
# 安装依赖
pip install -r requirements.txt

# 初始化数据库（创建管理员账户和示例数据）
python backend/init_db.py

# 启动服务器
python run.py
```

服务器将在 http://localhost:8000 启动

### 2. 访问应用

- **主界面**: http://localhost:8000/
- **API文档**: http://localhost:8000/docs
- **管理员面板**: http://localhost:8000/admin

## 👥 用户管理

### 管理员账户
- **用户名**: `admin`
- **密码**: `admin123`
- **权限**: 完全管理权限

### 普通用户注册

1. 访问主界面
2. 点击"注册"按钮
3. 填写注册信息：
   - 用户名（必填）
   - 密码（必填，最少6位）
   - 邀请码（必填，8位字符）
4. 点击注册

#### 示例邀请码
- `KFJBZ756` - 永久有效
- `276TYTSY` - 2025-10-02过期
- `Q5PGUSP8` - 2025-12-01过期

## 🎫 邀请码系统

### 生成邀请码

#### 管理员生成
1. 登录管理员账户
2. 访问 http://localhost:8000/admin
3. 在"邀请码管理"部分：
   - 设置过期时间（可选）
   - 点击"生成邀请码"

#### 普通用户生成
1. 登录普通用户账户
2. 点击导航栏的"兑换"按钮
3. 在弹出的模态框中可以生成邀请码

### 查看邀请码

#### 管理员查看
- 访问管理员面板
- 查看"邀请码列表"表格
- 显示所有邀请码的使用状态

#### 普通用户查看
- 点击导航栏的"管理"按钮（管理员权限）
- 查看个人生成的邀请码

## 💰 积分系统

### 积分获取
1. **注册赠送**: 新用户注册获得0积分
2. **兑换码兑换**: 使用兑换码获得积分
3. **管理员赠送**: 管理员可以直接修改用户积分

### 积分使用
- **图像生成**: 每次生成消耗1积分
- **图像编辑**: 每次编辑消耗1积分

### 兑换码使用
1. 点击导航栏的"兑换"按钮
2. 输入兑换码
3. 点击"兑换"按钮
4. 系统自动增加积分

#### 示例兑换码
- `XM0PE63PFVLO` - 10积分
- `KVFDLVTPWMX8` - 50积分
- `9DR9Y0YVVQQQ` - 100积分

## 🎨 图像生成

### 基本生成
1. 登录用户账户
2. 在左侧"提示引擎"区域：
   - 输入图像描述
   - 选择AI模型
   - 选择尺寸
   - 选择输出格式
3. 点击"生成图片"按钮
4. 等待生成完成（右侧显示结果）

### 图像编辑
1. 点击"选择图片"按钮
2. 上传要编辑的图片
3. 输入编辑描述
4. 点击"生成图片"按钮
5. 系统将基于上传的图片进行AI编辑

### 支持的模型
- **GPT-4o Image**: OpenAI最新模型
- **DALL-E 3**: 高质量图像生成
- **Stable Diffusion**: 开源模型

### 支持的尺寸
- **1024x1024**: 正方形（默认）
- **1024x1792**: 竖屏
- **1792x1024**: 横屏

## 📊 数据管理

### 用户管理（管理员）
1. 访问管理员面板
2. 查看用户列表
3. 可以：
   - 修改用户积分
   - 禁用/启用用户
   - 删除用户

### 历史记录
- 登录后自动显示生成历史
- 支持查看：
  - 生成的图片
  - 使用的提示词
  - 消耗的积分
  - 生成时间

## 🔧 系统配置

### 环境变量
```env
# 应用配置
SECRET_KEY=your-secret-key
DEBUG=true
PORT=8000

# 数据库配置
DATABASE_URL=sqlite:///./aipainter.db

# AI API配置
AI_API_KEY=sk-your-openai-key
AI_API_BASE_URL=https://api.openai.com

# 管理员配置
ADMIN_USERNAME=admin
ADMIN_PASSWORD=admin123
```

### 数据库重置
```bash
# 删除数据库文件
rm aipainter.db

# 重新初始化
python backend/init_db.py
```

## 🐛 故障排除

### 常见问题

#### 1. 注册失败
- 检查邀请码是否正确
- 确保邀请码未被使用且未过期
- 用户名是否已被注册

#### 2. 登录失败
- 检查用户名和密码是否正确
- 确认账户是否被管理员禁用

#### 3. 生成失败
- 检查积分是否足够（至少1积分）
- 确认网络连接正常
- 检查AI API密钥配置

#### 4. 邀请码无法使用
- 确认邀请码格式正确（8位字符）
- 检查邀请码是否过期
- 确认邀请码是否已被使用

### 日志查看
```bash
# 查看服务器日志
tail -f logs/server.log
```

### API测试
```bash
# 运行API测试
python test_api.py
```

## 📞 技术支持

- **API文档**: http://localhost:8000/docs
- **健康检查**: http://localhost:8000/health
- **系统状态**: 检查服务器控制台输出

如遇到问题，请查看控制台错误信息或联系开发团队。
